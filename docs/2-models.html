<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Reproducibility</title>
  <meta name="description" content="Bayesian Reproducibility">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Reproducibility" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Reproducibility" />
  
  
  

<meta name="author" content="Huijia Yu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="1-lit-review.html">
<link rel="next" href="3-normal-simulation-study.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-lit-review.html"><a href="1-lit-review.html"><i class="fa fa-check"></i><b>1</b> Literature Review</a></li>
<li class="chapter" data-level="2" data-path="2-models.html"><a href="2-models.html"><i class="fa fa-check"></i><b>2</b> Models</a><ul>
<li class="chapter" data-level="2.1" data-path="2-models.html"><a href="2-models.html#fully-bayesian-model"><i class="fa fa-check"></i><b>2.1</b> Fully Bayesian Model</a></li>
<li class="chapter" data-level="2.2" data-path="2-models.html"><a href="2-models.html#conditional-likelihood"><i class="fa fa-check"></i><b>2.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="2.3" data-path="2-models.html"><a href="2-models.html#bayes-factor-model"><i class="fa fa-check"></i><b>2.3</b> Bayes Factor Model</a></li>
<li class="chapter" data-level="2.4" data-path="2-models.html"><a href="2-models.html#prior-specifications"><i class="fa fa-check"></i><b>2.4</b> Prior Specifications</a></li>
<li class="chapter" data-level="2.5" data-path="2-models.html"><a href="2-models.html#methods"><i class="fa fa-check"></i><b>2.5</b> Methods</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Normal Simulation Study</a><ul>
<li class="chapter" data-level="3.1" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#data-generation"><i class="fa fa-check"></i><b>3.1</b> Data Generation</a></li>
<li class="chapter" data-level="3.2" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#conditional-likelihood-1"><i class="fa fa-check"></i><b>3.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="3.3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#posterior-distribution"><i class="fa fa-check"></i><b>3.3</b> Posterior Distribution</a></li>
<li class="chapter" data-level="3.4" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#results"><i class="fa fa-check"></i><b>3.4</b> Results</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#estimators"><i class="fa fa-check"></i><b>3.4.1</b> Estimators</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#credible-and-confidence-intervals"><i class="fa fa-check"></i><b>3.4.2</b> Credible and Confidence Intervals</a></li>
<li class="chapter" data-level="3.4.3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#coverage"><i class="fa fa-check"></i><b>3.4.3</b> Coverage</a></li>
<li class="chapter" data-level="3.4.4" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#hypothesis-rejection"><i class="fa fa-check"></i><b>3.4.4</b> Hypothesis Rejection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html"><i class="fa fa-check"></i><b>4</b> Hierarchical Simulations</a><ul>
<li class="chapter" data-level="4.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#data-generation-procedure"><i class="fa fa-check"></i><b>4.1</b> Data Generation Procedure</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#finding-discovery-sites"><i class="fa fa-check"></i><b>4.1.1</b> Finding “Discovery” Sites</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#results-1"><i class="fa fa-check"></i><b>4.2</b> Results</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#rmse-of-mu"><i class="fa fa-check"></i><b>4.2.1</b> RMSE of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="4.2.2" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#coverage-of-mu"><i class="fa fa-check"></i><b>4.2.2</b> Coverage of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="4.2.3" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#probability-of-association-xi"><i class="fa fa-check"></i><b>4.2.3</b> Probability of Association <span class="math inline">\(\xi\)</span></a></li>
<li class="chapter" data-level="4.2.4" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#sensitivity-of-conditional-likelihood-method-to-changes-in-alpha"><i class="fa fa-check"></i><b>4.2.4</b> Sensitivity of Conditional Likelihood Method to Changes in <span class="math inline">\(\alpha\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html"><i class="fa fa-check"></i><b>5</b> Analysis of TP53</a><ul>
<li class="chapter" data-level="5.1" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html#models-1"><i class="fa fa-check"></i><b>5.1</b> Models</a></li>
<li class="chapter" data-level="5.2" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html#results-2"><i class="fa fa-check"></i><b>5.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-conclusion.html"><a href="6-conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="chapter" data-level="7" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html"><i class="fa fa-check"></i><b>7</b> Supplementary Material</a><ul>
<li class="chapter" data-level="7.1" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html#jags-models"><i class="fa fa-check"></i><b>7.1</b> JAGS Models</a></li>
<li class="chapter" data-level="7.2" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html#joint-analysis-of-tp53-snps"><i class="fa fa-check"></i><b>7.2</b> Joint Analysis of TP53 SNPs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Reproducibility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="models" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Models</h1>
<p>Following the structure of the motivating example, consider a binary dataset describing an event such as whether or not someone has ovarian cancer. This data is collected across different sites, which may have different sampling procedures (as well as simply different populations). The mean effect for each site can be thought of as normally distributed around a global effect if this exists. This is the alternative hypothesis. The null hypothesis is that there is no global effect. This also means that there must not be a site effect. We are interested in two things: whether or not there is a global effect (hypothesis testing), and what the effect’s size is (inference). Let <span class="math inline">\(Y_{ij}\)</span> be the observed data. The <span class="math inline">\(j\)</span> index corresponds to the site to which the observation belongs.</p>
<p><span class="math display">\[P(Y_{ij}=1| \beta_j) = \textsf{logit}^{-1}(\beta_{j})\\
\beta_{j}|\mu, \sigma^2,H_1 \sim \textsf{N}(\mu, \sigma^{2})\\
\beta_{j}|H_0 = 0\]</span></p>
<p>In the case where we have multiple sites’ information, we can use this hierarchical model, but if we only have data from one discovery site, then the site effect becomes meaningless, and we can use the following model:</p>
<p><span class="math display">\[P(Y_{i}=1|\mu) = \textsf{logit}^{-1}(\mu)\]</span></p>
<p>We propose three different Bayesian approaches:</p>
<ol style="list-style-type: decimal">
<li><p>A fully Bayesian mixed effects hierarchical model that can jointly perform significance testing and effect estimation. By combining the testing and estimate steps, we can overcome the winner’s curse and account for the uncertainty that arises when selecting an SNP. This model builds on Xu et al., and Jiang et al., which introduce the spike-and-slab prior, with the addition of random effects to account for heterogeneity between sites.</p></li>
<li><p>A conditional likelihood model that can take into account the probability of finding a significant result in the discovery sites when estimating effect size. This model incorporates the conditional likelihood introduced by Zollner and Pritchard as well as Zhong and Prentice, and Ghosh et al.) and incorporates it into the Bayesian hierarchical framework.</p></li>
<li><p>A Bayes factor-based model that uses an upper bound on the Bayes factor from the discovery sites, which is more reliable than the p-value <span class="citation">(Benjamin et al., 2017)</span> to quantify the uncertainty of the significant result.</p></li>
</ol>
<p>While the first approach is truly Bayesian and requires all the data, the second and third can be used as long as the sufficient statistics (MLE, SE, p-value, <span class="math inline">\(\alpha\)</span>) are available.</p>
<div id="fully-bayesian-model" class="section level2">
<h2><span class="header-section-number">2.1</span> Fully Bayesian Model</h2>
<p>Let <span class="math inline">\(\delta_a(x)\)</span> be the Dirac delta function: <span class="math inline">\(\delta_a(x) = 1\)</span> for <span class="math inline">\(x = a\)</span> and <span class="math inline">\(\delta_a(x)=0\)</span> otherwise. Then, <span class="math inline">\(P( \mu|H_0) = \delta_0 ( \mu )\)</span>, and <span class="math inline">\(P( \mu|H_1) = N(0,1)\)</span> or some other diffuse prior. We can define a hyperparameter <span class="math inline">\(\xi\)</span> such that <span class="math inline">\(P(H_1) = \xi\)</span>. This gives rise to a latent variable drawn from a Bernoulli(<span class="math inline">\(\xi\)</span>), which is equivalent to selecting <span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_0\)</span>.</p>
<p>Site means <span class="math inline">\(\beta_{j}|\mu, \sigma^2,H_1 \sim N(\mu, \sigma^2)\)</span>, and <span class="math inline">\(\beta_{j}|H_0 = 0\)</span>. In this case the prior for <span class="math inline">\(\mu| H_1\)</span> was chosen to be a Cauchy distribution. The prior for <span class="math inline">\(\sigma\)</span> was a truncated Cauchy, with support only on the positive real line. The prior for <span class="math inline">\(\xi\)</span>, the probability of the alternative, was a Beta distribution.</p>
<p>The complete model is as follows:</p>
<p><span class="math display">\[\beta_{j}|H_ 1 \sim \textsf{N}(\mu, \sigma_{\beta}^{2}) \\
\mu|H_1\sim \textsf{Cauchy}(0,\sigma_{\mu}^{2})\\
\mu, \beta_{j}|H_0  =0\\
\sigma_{\beta}\sim \textsf{Cauchy}^+(0,\sigma_{\sigma}^{2})\\
H\sim \textsf{Bernoulli}(\xi)\\
\xi \sim \textsf{Beta}(a, b)\]</span></p>
<p><img src="thesis_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we only consider discovery data from one site, this model becomes the same as the one proposed by Xu et al. with slightly different priors.</p>
<p>There is no difference between discovery and validation sites in the Bayesian framework. Even considering them separately, one could consider the posterior distributions of the parameters given only discovery site data as the priors given the validation data, which would result in exactly the same results.</p>
</div>
<div id="conditional-likelihood" class="section level2">
<h2><span class="header-section-number">2.2</span> Conditional Likelihood</h2>
<p>In this case, the results from the discovery sites are used as a prior for the validation data analysis, which is why only the sufficient statistics are needed.</p>
<p>Given the discovery sites’ MLE and SE, we can use the CLT and definition of MLE to state that <span class="math inline">\(\text{MLE}_i \sim N(\beta_i, \text{SE}_i)\)</span>. Let <span class="math inline">\(B\)</span> indicate that the data is significant at the level <span class="math inline">\(\alpha\)</span>. The conditional likelihood is <span class="math display">\[L(\mu | B) = \frac{p(Y| \mu)p(B| Y,\mu)}{p(B|\mu)} =  \frac{p(Y| \mu)}{\int_{\textsf{significant Y}} p(t| \mu) dt }\]</span></p>
<p>Conditioning on finding a significant estimate using a Normal approximation, <span class="math display">\[p(\text{MLE}_i | B,\beta_i,\text{SE}_i,q_i) = \frac{\phi(\text{MLE}_i, \beta_i, \text{SE}_i)}{\Phi(-q_i, \beta_i, \text{SE}_i)+1-\Phi(q_i, \beta_i, \text{SE}_i)}\]</span> where <span class="math inline">\(\phi(x, \beta_i, \sigma)\)</span> is the pdf of a normal distribution with mean <span class="math inline">\(\beta_i\)</span> and variance <span class="math inline">\(\sigma^2\)</span>, and <span class="math inline">\(\Phi(x, \beta_i, \sigma)\)</span> is the cdf of the same distribution. The value of <span class="math inline">\(q_i\)</span> is <span class="math inline">\(\Phi^{-1}(1-\frac{\alpha}{2}, 0 ,\text{SE}_i)\)</span>, where <span class="math inline">\(\alpha\)</span> is the power of the test (i.e. p-values that are smaller than <span class="math inline">\(\alpha\)</span> are considered significant). This is cutoff for an MLE value to be considered significant. Let the conditional likelihood of <span class="math inline">\(\text{MLE}_i\)</span> be denoted as <span class="math inline">\(\textsf{CL}(\beta_i,\text{SE}_i, q_i)\)</span>.</p>
<p><img src="thesis_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see that as <span class="math inline">\(\alpha\)</span> decreases (i.e. the tests are more strict), the likelihood becomes more skewed towards 0.</p>
<p>The conditional likelihood of <span class="math inline">\(\beta_{ j}, j\in \text{discovery}\)</span> becomes the posterior of this variable if we use a uniform prior, since the likelihood will just be multiplied by one.</p>
<p>In the discovery-only case, this is enough to create credible intervals for <span class="math inline">\(\mu\)</span> by sampling from the posterior (as opposed to maximizing the conditional likelihood or approximating the surface).</p>
<p>In the hierarchical setting, the posteriors for the discovery sites are used as the priors for the validation data; that is, <span class="math inline">\(p(\mu| \beta_i, \text{MLE}_i,\text{SE}_i, q_i, i \in \text{discovery})\)</span> is the prior for the hierarchical model using validation data.</p>
<p>The updated model is:</p>
<p><span class="math display">\[\beta_{j}|\mu, \sigma_{\beta}^{2} \sim \textsf{N}(\mu, \sigma_{\beta}^{2}) , j \in \text{validation}\\
\text{MLE}_{j}|\beta_{j},\text{SE}_{j}, q_j \sim \textsf{CL}(\beta_{j},\text{SE}_{j}, q_j) , j \in \text{discovery}\\
\sigma_{\beta}\sim \textsf{Cauchy}^+(0,\sigma^2_{\sigma})\]</span></p>
<p>Note that the selection uncertainty is somewhat accounted for through the conditional likelihood, but there is no measure of this uncertainty. By using the discovery MLEs, we are already assuming that there is a nonzero effect.</p>
</div>
<div id="bayes-factor-model" class="section level2">
<h2><span class="header-section-number">2.3</span> Bayes Factor Model</h2>
<p>The discovery data can be used not only in estimating the distribution of the size of a preestablished effect (<span class="math inline">\(\mu\)</span>), but in estimating the distribution of the probability of the effect itself (<span class="math inline">\(\xi = P(H_1)\)</span>). To make this model easily generalizable, we use the upper bound on the Bayes Factor <span class="math display">\[BF_{H_1:H_0} = \frac{L(\bar Y | H_1)}{L(\bar Y | H_0)} \leq \frac{1}{-e p log(p)}\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the p-value from the discovery data <span class="citation">(Sellke et al., 2001)</span>. This is a “best-case scenario” of how much evidence there is from data given a particular p-value. Since this value is fixed given the discovery data, we can then consider the “posterior”&quot; probability of true association <span class="math inline">\(\xi\)</span> given the discovery p-value as a transformation of <span class="math inline">\(\xi\)</span>, which is parametrized with prior Beta(.5,.5). Let <span class="math inline">\(o\)</span> be the prior odds <span class="math inline">\(\frac{1-\xi}{\xi}\)</span>. <span class="math display">\[\xi&#39; = \frac{P(H_1)*L(Y|H_1)}{P(H_0)*L(Y|H_0)+P(H_1)*L(Y|H_1)} = \frac{o*BF_{H_1}}{1+o*BF_{H_1}}\]</span> Then <span class="math inline">\(\xi&#39;\)</span> can be used in the fully Bayesian model, but only with the validation data.</p>
<p><img src="thesis_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>In this case, the discovery data will have an effect on the amount of zero-valued global effects sampled because it skews the distribution to the right. However, since in this specific model we do not use the effect estimates from the discovery data, we essentially throw away any information regarding the size of the effect. These can be added in future models to better utilize the discovery data.</p>
</div>
<div id="prior-specifications" class="section level2">
<h2><span class="header-section-number">2.4</span> Prior Specifications</h2>
<p>The choice of Cauchy priors for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2_{\beta}\)</span> is based on simulation results. Both priors had mean zero and variance 1, based on the usual range of effect sizes in GWAS. The hyperparameters for <span class="math inline">\(\xi\)</span> were set to <span class="math inline">\(a = b= \frac{1}{2}\)</span>. This distribution has a U-shape so that it favors extreme probabilities (0 or 1) more heavily than the values between them.</p>
<p>The normal approximation for the conditional likelihood model was chosen for its simplicity and because of the large sample sizes of GWAS, which allow for CLT assumptions.</p>
<p>For the Bayes Factor model, <span class="math inline">\(a = b= \frac{9}{10}\)</span>. This is because for small p-values, the transformation of <span class="math inline">\(\xi\)</span> can be very extreme. For a GWAS p-value <span class="math inline">\(p = 10^{-7}\)</span> and <span class="math inline">\(\xi \sim \textsf{Beta}(.5,.5)\)</span> , <span class="math inline">\(P( \xi&#39; \leq 0.5) =\)</span> <span class="math inline">\(4.74\times 10^{-11}\)</span> . For the flatter prior: <span class="math inline">\(\xi \sim \textsf{Beta}(.9,.9)\)</span>, <span class="math inline">\(P( \xi&#39; \leq 0.5) =\)</span> <span class="math inline">\(1.24\times 10^{-6}\)</span>.</p>
<p>The Bayes Factor model is extremely sensitive to the choice of prior as well as to the p-value. While the skew is appropriate for this particular prior, it would not necessarily make sense with a flat or informative prior.</p>
</div>
<div id="methods" class="section level2">
<h2><span class="header-section-number">2.5</span> Methods</h2>
<p>Models were fit using R2jags and in the simpler cases, with original Metropolis Hastings algorithms. To specify distributions that are not part of the R2jags library, such as the conditional likelihood, we use the “ones trick”, which is implement by creating artificial observations of a Bernoulli variable. Consider a prior for <span class="math inline">\(\theta\)</span> that is proportional to <span class="math inline">\(\pi(\theta)\)</span>. If we set that Bernoulli variable “ones” is equal to 1 with probability <span class="math inline">\(\pi(\theta)\)</span>, create an observation “ones”<span class="math inline">\(= 1\)</span>, and set a uniform prior for <span class="math inline">\(\theta\)</span>, then we are effectively creating a “posterior” for theta that is proportional to <span class="math inline">\(\pi(\theta)\)</span> as intended.</p>
<p>Each JAGS model was run with the default settings: 3 chains, 2000 iterations, and 1000 burn-in samples. JAGS model functions for the hierarchical simulations can be found in the supplement.</p>
<p>All computed credible intervals are HPD (highest posterior density) intervals. A 95% HPD interval is the 95% of the sampled values with the highest density. HPD intervals are guaranteed to be the shortest intervals for that scale (they are not scale-invariant), and can give more reasonable answers for multimodal distributions than quantile-based intervals because they can be disjoint.</p>
<p>Point estimates were calculated used the posterior median, so that these estimates would be invariant to transformations (e.g. log).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1-lit-review.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="3-normal-simulation-study.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
