<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Reproducibility</title>
  <meta name="description" content="Bayesian Reproducibility">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Reproducibility" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Reproducibility" />
  
  
  

<meta name="author" content="Huijia Yu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="2-lit-review.html">
<link rel="next" href="4-tp53.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-abstract.html"><a href="1-abstract.html"><i class="fa fa-check"></i><b>1</b> Abstract</a></li>
<li class="chapter" data-level="2" data-path="2-lit-review.html"><a href="2-lit-review.html"><i class="fa fa-check"></i><b>2</b> Literature Review</a></li>
<li class="chapter" data-level="3" data-path="3-simulation-study.html"><a href="3-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Simulation Study</a><ul>
<li class="chapter" data-level="3.1" data-path="3-simulation-study.html"><a href="3-simulation-study.html#normal-example"><i class="fa fa-check"></i><b>3.1</b> Normal Example</a><ul>
<li class="chapter" data-level="3.1.1" data-path="3-simulation-study.html"><a href="3-simulation-study.html#data-generation"><i class="fa fa-check"></i><b>3.1.1</b> Data Generation</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-simulation-study.html"><a href="3-simulation-study.html#conditional-likelihood"><i class="fa fa-check"></i><b>3.1.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="3.1.3" data-path="3-simulation-study.html"><a href="3-simulation-study.html#posterior-distribution"><i class="fa fa-check"></i><b>3.1.3</b> Posterior Distribution</a></li>
<li class="chapter" data-level="3.1.4" data-path="3-simulation-study.html"><a href="3-simulation-study.html#results"><i class="fa fa-check"></i><b>3.1.4</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-tp53.html"><a href="4-tp53.html"><i class="fa fa-check"></i><b>4</b> TP53</a><ul>
<li class="chapter" data-level="4.1" data-path="4-tp53.html"><a href="4-tp53.html#data"><i class="fa fa-check"></i><b>4.1</b> Data</a></li>
<li class="chapter" data-level="4.2" data-path="4-tp53.html"><a href="4-tp53.html#previous-studies"><i class="fa fa-check"></i><b>4.2</b> Previous Studies</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-models.html"><a href="5-models.html"><i class="fa fa-check"></i><b>5</b> Models</a><ul>
<li class="chapter" data-level="5.1" data-path="5-models.html"><a href="5-models.html#fully-bayesian-model"><i class="fa fa-check"></i><b>5.1</b> Fully Bayesian Model</a></li>
<li class="chapter" data-level="5.2" data-path="5-models.html"><a href="5-models.html#conditional-likelihood-1"><i class="fa fa-check"></i><b>5.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="5.3" data-path="5-models.html"><a href="5-models.html#bayes-factor-model"><i class="fa fa-check"></i><b>5.3</b> Bayes Factor Model</a></li>
<li class="chapter" data-level="5.4" data-path="5-models.html"><a href="5-models.html#methods"><i class="fa fa-check"></i><b>5.4</b> Methods</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html"><i class="fa fa-check"></i><b>6</b> Hierarchical Simulations</a><ul>
<li class="chapter" data-level="6.1" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html#data-generation-procedure"><i class="fa fa-check"></i><b>6.1</b> Data Generation Procedure</a><ul>
<li class="chapter" data-level="6.1.1" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html#finding-discovery-sites"><i class="fa fa-check"></i><b>6.1.1</b> Finding “Discovery” Sites</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html#results-1"><i class="fa fa-check"></i><b>6.2</b> Results</a><ul>
<li class="chapter" data-level="6.2.1" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html#sensitivity"><i class="fa fa-check"></i><b>6.2.1</b> Sensitivity</a></li>
<li class="chapter" data-level="6.2.2" data-path="6-hierarchical-simulations.html"><a href="6-hierarchical-simulations.html#sensitivity-of-conditional-likelihood-method-to-changes-in-alpha"><i class="fa fa-check"></i><b>6.2.2</b> Sensitivity of Conditional Likelihood Method to Changes in <span class="math inline">\(\alpha\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-analysis-of-tp53-data.html"><a href="7-analysis-of-tp53-data.html"><i class="fa fa-check"></i><b>7</b> Analysis of TP53 Data</a></li>
<li class="chapter" data-level="8" data-path="8-conclusions-and-future-work.html"><a href="8-conclusions-and-future-work.html"><i class="fa fa-check"></i><b>8</b> Conclusions and Future Work</a><ul>
<li class="chapter" data-level="8.1" data-path="8-conclusions-and-future-work.html"><a href="8-conclusions-and-future-work.html#conclusion"><i class="fa fa-check"></i><b>8.1</b> Conclusion</a></li>
<li class="chapter" data-level="8.2" data-path="8-conclusions-and-future-work.html"><a href="8-conclusions-and-future-work.html#future-work"><i class="fa fa-check"></i><b>8.2</b> Future Work</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Reproducibility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulation-study" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Simulation Study</h1>
<div id="normal-example" class="section level2">
<h2><span class="header-section-number">3.1</span> Normal Example</h2>
<div id="data-generation" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Data Generation</h3>
<p>To test the hypothesis <span class="math inline">\(H_0: mu = 0\)</span> versus <span class="math inline">\(H_1: mu \neq 0\)</span>, a fixed proportion (set at 0.5) of null vs. alternative hypotheses are generated. For each hypothesis <span class="math inline">\(H_i\)</span>, let <span class="math inline">\(mu_i = 0\)</span> in the null scenario and <span class="math inline">\(mu_i \sim N(0,1)\)</span> in the alternative. The data <span class="math inline">\(Y_i\)</span> is generated from a normal distribution with mean <span class="math inline">\(mu_i\)</span> and known variance 1, with sample size 100. If <span class="math inline">\(Y_i\)</span> is not significant at <span class="math inline">\(alpha = .05\)</span>, it is sampled again from the same distribution until the sufficient statistic is significant. This is done in order to properly compare the Bayesian approach with the frequentist one, which is conditional on the data being significant.</p>
</div>
<div id="conditional-likelihood" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Conditional Likelihood</h3>
<p>Let <span class="math inline">\(B\)</span> indicate that the data is significant at the level <span class="math inline">\(\alpha\)</span>. The conditional likelihood <span class="math inline">\(L(\mu | B) = \frac{P(Y| \mu)P(B| Y,\mu)}{P(B|\mu)} = \frac{P(Y| \mu)}{\int_{\text{significant Y}} P(t| \mu) dt }\)</span>.<references here?> In this case, the sufficient statistic can be used to simplify: since <span class="math inline">\(\bar Y \sim N(\mu, \sigma^2/n)\)</span>, the conditional likelihood for the simulated data is equivalent to <span class="math inline">\(L(\mu|\bar Y) = \frac{\phi((\bar Y-\mu)/\sqrt{n})}{\Phi(Z_{\alpha/2}-\mu\sqrt{n})+\Phi(Z_{1-\alpha/2}-\mu\sqrt{n})}\)</span>.</p>
<p>Since this likelihood is difficult to integrate analytically, the confidence intervals were estimated by treating the conditional likelihood as if it were a posterior distribution with an improper prior <span class="math inline">\(\pi(\mu) = 1\)</span>, and obtaining the HPD (highest posterior density) region covering 95%. Sampling was done through a Metropolis-Hastings algorithm.</p>
</div>
<div id="posterior-distribution" class="section level3">
<h3><span class="header-section-number">3.1.3</span> Posterior Distribution</h3>
<p>Let <span class="math inline">\(\delta_a(x)\)</span> be the Dirac delta function: <span class="math inline">\(\delta_a(x) = 1\)</span> for <span class="math inline">\(x = a\)</span> and <span class="math inline">\(\delta_a(x)=0\)</span> otherwise. In the Bayesian case, the prior was set to a spike and slab prior, with the “spike” being a point mass at 0: <span class="math inline">\(\pi(\mu|H=H_0) = \delta_0(\mu)\)</span>, and the “slab” part corresponding to a unit information prior: <span class="math inline">\(\pi(\mu|H=H_1) \sim N(0, 1)\)</span>. The full prior is a mixture model <span class="math inline">\(\pi(\mu|\xi) = (1-\xi ) \delta_0(\mu)+ \xi\phi(\mu)\)</span>. In this case, <span class="math inline">\(\xi = 0.5\)</span> is a constant. Note that this is also the true data generating model.</p>
<p>The marginal posterior distribution is <span class="math inline">\(P(\mu | Y ) = P(H_0|Y)P(\mu|Y, H_0) + P(H_1|Y)P(\mu|Y, H_1)\)</span>. The separate posteriors for <span class="math inline">\(\mu\)</span> are: <span class="math inline">\(P(\mu|Y, H_0) = \delta_0(\mu)\)</span>, <span class="math inline">\(P(\mu|Y, H_1) \sim N(\frac{n}{n+1}\bar Y, \frac{1}{n+1})\)</span>. The posterior for the alternative hypothesis can be calculated using its bayes factor, BF and the prior odds, <span class="math inline">\(\pi = \frac{(1-\xi)}{\xi}\)</span>: <span class="math inline">\(P(H_1| Y ) = \frac{\pi BF}{1+\pi BF}\)</span>. For this example, the prior odds are 1 (because the probability of <span class="math inline">\(H_1 = \xi = 0.5\)</span>). The bayes factor <span class="math inline">\(BF = \frac{L(\bar Y | H_1)}{L(\bar Y | H_0)} = \sqrt{n+1} exp(\frac{n^2}{2(n+1)}(\bar Y)^2)\)</span>. This result comes from the fact that the marginal likelihood <span class="math inline">\(L(\bar Y | H_1) \sim N(0, \frac{n}{n+1})\)</span>.</p>
<p>Putting these pieces together results in the marginal posterior for <span class="math inline">\(\mu\)</span>, which can be used to generate samples to calculate HPD credible intervals.</p>
<p>While true HPD intervals can be disjoint, the intervals calculated for this experiment are actually the shortest continuous segments covering <span class="math inline">\(.95\)</span>. This corresponds to the HPD interval under the assumption that the distribution is not severely multimodal, and is what most packages in R use to estimate HPD intervals. However, since this posterior is actually a mixture model, a large enough posterior probability for <span class="math inline">\(H_1\)</span> could lead to a difference between the true HPD credible interval and the calculated one. <this will be addressed in the future etc></p>
</div>
<div id="results" class="section level3">
<h3><span class="header-section-number">3.1.4</span> Results</h3>
<div id="estimators" class="section level4">
<h4><span class="header-section-number">3.1.4.1</span> Estimators</h4>
<pre><code>No id variables; using all as measure variables</code></pre>
<p><img src="thesis_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>bayes</td>
<td align="right">3.810038</td>
</tr>
<tr class="even">
<td>bayes.median</td>
<td align="right">4.328932</td>
</tr>
<tr class="odd">
<td>bayes.mode</td>
<td align="right">4.328932</td>
</tr>
<tr class="even">
<td>cond.mean</td>
<td align="right">3.931742</td>
</tr>
<tr class="odd">
<td>cond.mode</td>
<td align="right">3.868903</td>
</tr>
<tr class="even">
<td>naive</td>
<td align="right">4.986346</td>
</tr>
</tbody>
</table>
<p>The conditional likelihood mode (i.e. MLE) has the smallest bias (absolute error) for <span class="math inline">\(\mu\)</span> out of the frequentist estimators, while the bayesian median and mode (which end up being the same) the smallest bias in the bayesian framework. The RMSE for the bayesian estimator (mean of the posterior) is the lowest, followed by the conditional mean and mode.</p>
</div>
<div id="credible-and-confidence-intervals" class="section level4">
<h4><span class="header-section-number">3.1.4.2</span> Credible and Confidence Intervals</h4>
<p><img src="thesis_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The lines mark the <span class="math inline">\(y = x\)</span> line, and the length of naive confidence intervals (which are constant for fixed number of samples) on the x and y axes.</p>
<p>The largest values for the significant statistic also correspond to the largest intervals in both cases. Note that the conditional likelihood confidence intervals are almost always larger than the credible intervals, but still mostly smaller than the naive ones.</p>
</div>
<div id="coverage" class="section level4">
<h4><span class="header-section-number">3.1.4.3</span> Coverage</h4>
<p>The marginal coverage of the (frequentist conditional likelihood) confidence interval C, <span class="math inline">\(P(\mu \in C|Y) = P(\mu \in C|H_0) P(H_0|Y)+P(\mu \in C|H_1) P(H_1|Y)\)</span> will be significantly higher than .95 for the cases in which <span class="math inline">\(0 \in C\)</span>, since <span class="math inline">\(P(\mu \in C|H_1) =0.95\)</span> by definition, and <span class="math inline">\(P(\mu \in C|H_0) = I_{0 \in C}\)</span>. In this experiment, the expected coverage is <span class="math inline">\(0.98\)</span> for intervals with 0, and only <span class="math inline">\(0.38\)</span> for those that do not contain 0.</p>
<p>However, conditioning on the alternative hypothesis does not lead to an empirical coverage of 95%.</p>
<p>We can see that both methods are still significantly better than the naive one.</p>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 3.1: </span>Empirical Coverage for 95% Confidence/Credible Intervals</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Unconditional Coverage</th>
<th align="right">Coverage Conditional on H0</th>
<th align="right">Coverage Conditional on H1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>naive</td>
<td align="right">0.6572238</td>
<td align="right">0.6235294</td>
<td align="right">0.7448980</td>
</tr>
<tr class="even">
<td>conditional</td>
<td align="right">0.8810198</td>
<td align="right">1.0000000</td>
<td align="right">0.5714286</td>
</tr>
<tr class="odd">
<td>bayesian</td>
<td align="right">0.8824363</td>
<td align="right">1.0000000</td>
<td align="right">0.5765306</td>
</tr>
</tbody>
</table>
</div>
<div id="hypothesis-rejection" class="section level4">
<h4><span class="header-section-number">3.1.4.4</span> Hypothesis Rejection(??)</h4>
<p>Due to the nature of p-values, an <span class="math inline">\(\alpha = 0.05\)</span> corresponds to a posterior probability <span class="math inline">\(P(H_1 | Y )\)</span> of only <span class="math inline">\(0.4\)</span> for <span class="math inline">\(N = 100\)</span>. This means that the 95% credible interval for <span class="math inline">\(\mu| Y\)</span> will contain 0 every time. In terms of hypothesis testing, if we consider the strategy of rejecting the null when the interval does not contain 0, this level for <span class="math inline">\(\alpha\)</span> leads to no rejections.</p>
<table>
<caption><span id="tab:unnamed-chunk-9">Table 3.2: </span>Naive method</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Do not reject null</th>
<th align="right">Reject null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td align="right">0.2719547</td>
<td align="right">0.4504249</td>
</tr>
<tr class="even">
<td>1</td>
<td align="right">0.1373938</td>
<td align="right">0.1402266</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-9">Table 3.2: </span>Conditional Likelihood Method</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Do not reject null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td align="right">0.7223796</td>
</tr>
<tr class="even">
<td>1</td>
<td align="right">0.2776204</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-9">Table 3.2: </span>Bayesian Mixture Model</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Do not reject null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td align="right">0.7223796</td>
</tr>
<tr class="even">
<td>1</td>
<td align="right">0.2776204</td>
</tr>
</tbody>
</table>
<p>Despite never rejecting the null, the conditional likelihood and the bayesian methods both perform better than the naive one in terms of “predicting” accurately. The naive method is especially problematic in that it has a higher Type 1 error (false positives) than true positives OR true negatives in the region of the data.</p>
<p><strong>## Double Exponential Simulation with Adjusted P-Values</strong></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2-lit-review.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="4-tp53.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
