<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Bayesian Reproducibility</title>
  <meta name="description" content="Bayesian Reproducibility">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Bayesian Reproducibility" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Reproducibility" />
  
  
  

<meta name="author" content="Huijia Yu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="5-analysis-of-tp53.html">
<link rel="next" href="7-supplementary-material.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="1-lit-review.html"><a href="1-lit-review.html"><i class="fa fa-check"></i><b>1</b> Literature Review</a></li>
<li class="chapter" data-level="2" data-path="2-models.html"><a href="2-models.html"><i class="fa fa-check"></i><b>2</b> Models</a><ul>
<li class="chapter" data-level="2.1" data-path="2-models.html"><a href="2-models.html#fully-bayesian-model"><i class="fa fa-check"></i><b>2.1</b> Fully Bayesian Model</a></li>
<li class="chapter" data-level="2.2" data-path="2-models.html"><a href="2-models.html#conditional-likelihood"><i class="fa fa-check"></i><b>2.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="2.3" data-path="2-models.html"><a href="2-models.html#bayes-factor-model"><i class="fa fa-check"></i><b>2.3</b> Bayes Factor Model</a></li>
<li class="chapter" data-level="2.4" data-path="2-models.html"><a href="2-models.html#prior-specifications"><i class="fa fa-check"></i><b>2.4</b> Prior Specifications</a></li>
<li class="chapter" data-level="2.5" data-path="2-models.html"><a href="2-models.html#methods"><i class="fa fa-check"></i><b>2.5</b> Methods</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html"><i class="fa fa-check"></i><b>3</b> Normal Simulation Study</a><ul>
<li class="chapter" data-level="3.1" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#data-generation"><i class="fa fa-check"></i><b>3.1</b> Data Generation</a></li>
<li class="chapter" data-level="3.2" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#conditional-likelihood-1"><i class="fa fa-check"></i><b>3.2</b> Conditional Likelihood</a></li>
<li class="chapter" data-level="3.3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#posterior-distribution"><i class="fa fa-check"></i><b>3.3</b> Posterior Distribution</a></li>
<li class="chapter" data-level="3.4" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#results"><i class="fa fa-check"></i><b>3.4</b> Results</a><ul>
<li class="chapter" data-level="3.4.1" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#estimators"><i class="fa fa-check"></i><b>3.4.1</b> Estimators</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#credible-and-confidence-intervals"><i class="fa fa-check"></i><b>3.4.2</b> Credible and Confidence Intervals</a></li>
<li class="chapter" data-level="3.4.3" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#coverage"><i class="fa fa-check"></i><b>3.4.3</b> Coverage</a></li>
<li class="chapter" data-level="3.4.4" data-path="3-normal-simulation-study.html"><a href="3-normal-simulation-study.html#hypothesis-rejection"><i class="fa fa-check"></i><b>3.4.4</b> Hypothesis Rejection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html"><i class="fa fa-check"></i><b>4</b> Hierarchical Simulations</a><ul>
<li class="chapter" data-level="4.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#data-generation-procedure"><i class="fa fa-check"></i><b>4.1</b> Data Generation Procedure</a><ul>
<li class="chapter" data-level="4.1.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#finding-discovery-sites"><i class="fa fa-check"></i><b>4.1.1</b> Finding “Discovery” Sites</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#results-1"><i class="fa fa-check"></i><b>4.2</b> Results</a><ul>
<li class="chapter" data-level="4.2.1" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#rmse-of-mu"><i class="fa fa-check"></i><b>4.2.1</b> RMSE of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="4.2.2" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#coverage-of-mu"><i class="fa fa-check"></i><b>4.2.2</b> Coverage of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="4.2.3" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#probability-of-association-xi"><i class="fa fa-check"></i><b>4.2.3</b> Probability of Association <span class="math inline">\(\xi\)</span></a></li>
<li class="chapter" data-level="4.2.4" data-path="4-hierarchical-simulations.html"><a href="4-hierarchical-simulations.html#sensitivity-of-conditional-likelihood-method-to-changes-in-alpha"><i class="fa fa-check"></i><b>4.2.4</b> Sensitivity of Conditional Likelihood Method to Changes in <span class="math inline">\(\alpha\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html"><i class="fa fa-check"></i><b>5</b> Analysis of TP53</a><ul>
<li class="chapter" data-level="5.1" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html#models-1"><i class="fa fa-check"></i><b>5.1</b> Models</a></li>
<li class="chapter" data-level="5.2" data-path="5-analysis-of-tp53.html"><a href="5-analysis-of-tp53.html#results-2"><i class="fa fa-check"></i><b>5.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-conclusion.html"><a href="6-conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a></li>
<li class="chapter" data-level="7" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html"><i class="fa fa-check"></i><b>7</b> Supplementary Material</a><ul>
<li class="chapter" data-level="7.1" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html#jags-models"><i class="fa fa-check"></i><b>7.1</b> JAGS Models</a></li>
<li class="chapter" data-level="7.2" data-path="7-supplementary-material.html"><a href="7-supplementary-material.html#joint-analysis-of-tp53-snps"><i class="fa fa-check"></i><b>7.2</b> Joint Analysis of TP53 SNPs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Reproducibility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conclusion" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Conclusion</h1>
<p>We expand on three ideas from current literature to deal with the winner’s curse by reducing the selection effect in initial studies that test for significance, as well as in replicated ones that aim to validate previous discoveries. The fully Bayesian model uses all the data to make inference and uses a binary latent variable to model the true association. This is equivalent to a spike and slab prior, or to model averaging with two possible models: the null and the alternative. The conditional likelihood method uses the likelihood of the estimate conditional on being significant. This is a frequentist approach to selection bias, and it depends on the significance test level as well as the effect estimate and standard error. The conditional likelihood is then used as a prior in the (Bayesian) validation analysis. The Bayes factor approximation method uses an upper bound on the Bayes factor that is only dependent on the p-value to calculate a “best-case scenario” posterior probability of the alternative hypothesis. The distribution that arises from this transformation is used as the prior of the association probability in the validation analysis. This approach also has a frequentist component, since p-values are used, but is a step towards the Bayesian framework since the only function of the p-value is to approximate the Bayes Factor. All models improve upon naive methods in the discovery phase, as shown in the normal simulation study, as well as the validation phase, as shown in the hierarchical simulation study and analysis of p53 data.</p>
<p>One clear advantage of the fully Bayesian model is that it can perform testing and estimation simultaneously. This means all the data is used once, which is why the credible intervals are smaller and the RMSE is lower in the simulations. However, it is not always feasible to implement if the discovery data is unavailable. Furthermore, Bayesian methods are not enough to not guarantee bias correction. They must take into account the selection mechanism (as is done here), and also report the uncertainty that is associated with this. Ignoring the selection effect or reporting only the selected interval can lead to paradoxes, especially for conjugate priors in multivariate inference, as was the case with the original model for the p53 analysis <span class="citation">(Dawid, 1994)</span>.</p>
<p>The conditional likelihood and Bayes factor approximation methods can be used in follow-up studies even when the discovery data is not publicly available. Both provide significant improvements over the naive method. The Bayes factor model has a quasi-testing feature since it accounts for the probability of a true association, but is very sensitive to the p-value as well as the choice of prior, and can be illogical for a prior such as the uniform.</p>
<p>Although the conditional likelihood itself is dependent on the significance test, this prior is only used for the discovery sites, and can be thought of as a posterior distribution under a flat prior. Under a hierarchical model, the global effect is actually unaffected by the <span class="math inline">\(\alpha\)</span> level. This is extremely useful because discoveries that do not have are not significant at the <span class="math inline">\(10^{-7}\)</span> level can still be used without affecting the results. However, the level <span class="math inline">\(\alpha\)</span> is crucial in the discovery phase. The integration over all significant events is simple to compute in this case, but might not be as simple for other distributions. For example, if one chooses to do Bayesian variable selection the conditional likelihood becomes intractable and must be approximated <span class="citation">(Panigrahi, Taylor, &amp; Weinstein, 2016)</span>. In this case, an adaptation of the fully Bayesian model may actually be more computationally feasible.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-analysis-of-tp53.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7-supplementary-material.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
