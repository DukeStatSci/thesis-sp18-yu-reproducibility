[
["index.html", "My Final College Paper Introduction", " My Final College Paper Huijia Yu May 2018 Introduction "],
["1-abstract.html", "Chapter 1 Abstract", " Chapter 1 Abstract "],
["2-intro.html", "Chapter 2 Introduction", " Chapter 2 Introduction "],
["3-lit-review.html", "Chapter 3 Literature Review", " Chapter 3 Literature Review P-values have been the reason behind lack of reproducibility in scientific discoveries, causing concern and leading to proposals of new ways to define significance. Benjamin et. al have shown that the Bayes factor equivalents for commonly used p-values only correspond to “weak” evidence in the Bayes factor characterization. (Benjamin et al., 2017) They suggest reducing the p-value threshold in studies with less power, but acknowledge that hypothesis testing with thresholding is still an issue. Another approach is suggested by Selke et al , who propose two calibrations of the p-value: as the lower bound of the Bayes factor under any alternative hypothesis, and as a posterior probability of the type 1 error in a Bayesian framework (Sellke, Bayarri, &amp; Berger, 2001). This problem has become a major issue in replicated studies, an effect known as the “winner’s curse” (Zöllner &amp; Pritchard, 2007) or the Beavis effect (S. Xu, 2003). Zollner and Pritchard first define this in the context of genome-wide association scans (GWAS), which use stringent thresholds for significance, resulting in inflated effect sizes after selection, especially since these are calculated with the same data. Thus, replication studies underestimate the sample size necessary and do not have enough power to detect an effect. Zollner and Pritchard suggest a conditional-likelihood based method to address this issue. They propose a computational algorithm to maximize over the the likelihood of the parameters conditional on the significance association at level \\(\\alpha\\), which results in less biased coefficient estimates (albeit with larger variance) and sample size estimates centered at the true value.(Zöllner &amp; Pritchard, 2007) Zhong and Prentice also propose a similar method, but use a different parametrization and an asymptotic approximation instead of a computational one to find the estimators, which is more computationally efficient (Zhong &amp; Prentice, 2008). Ghosh et al. also define an approximate conditional likelihood, and propose two more estimators (other than the MLE): the mean of the (normalized) conditional likelihood, which can be interpreted as a posterior mean of the parameters under a flat prior, and a “compromise” estimator which is the average of the mean and MLE (Ghosh, Zou, &amp; Wright, 2008). The combination estimator proves to have the most stable MSE accross the range of true values for the parameters. Their approach only requires summary statistics, so they further apply it to published datasets. The results are similar for the three conditional likelihood approaches, which have been applied to other studies such as Palmer and Peter . Another method proposed to create bias-reduced estimates uses bootstrap re-sampling to correct for both the thresholding effect and the ranking effect, which is not addressed in the conditional likelihood methods because of the difficulty of specifying joint likelihoods for correlated variables (Sun et al., 2011). By using a sample-split approach, the detection and estimation datasets can be virtually independent. This is repeated multiple times in order to reduce variance in the results. The main drawback of this approach is its computational intensity. Several authors have also proposed shrinkage-based methods in the effect detection step. Bacanu and Kendler use a soft threshold method to scale statistics such that their sum of squares do not overestimate the true mean and then find “suggestive” signals in a GWAS context by setting a threshold. This method does not address the winner’s curse directly, but provides a subset of the genome which can be futher analyzed or used in future studies (Bacanu &amp; Kendler, 2013). Bigdelli et al. propose shrinking coefficient estimates by drawing a comparison between “winner’s curse adjustments” for effect sizes and multiple testing approaches for p-values, since both are used on the tail of their respective distributions. Their method transforms False Discovery Rate (FDR) adjusted p-values into the corresponding Z-score and uses that as the estimator.(Bigdeli et al., 2016) Both Bigdelli and Bacanu assume the data is normally distributed. Storey and Tibshirani , on the other hand, propose to adjust the value used for significance testing rather than the coefficients, choosing the FDR value as an alternative to the p-value. Multiple Bayesian methods have also been proposed: Xu et al use a Bayesian approach to a logistic regression, selecting a spike and slab prior for the mean and an inverse gamma prior for the variance. (L. Xu, Craiu, &amp; Sun, 2011) A beta prior for the proportion of each component in the prior, and the hyperparameters were estimated empirically. They also propose a Bayesian Model Average approach, which they recommend for instances with little prior information. Their results show that the Bayesian models had smaller variance than conditional likelihood methods, but still do not address the “ranking effect” from Sun (Sun et al., 2011), or implement a fully Bayesian approach because of the dependence on the threshold \\(\\alpha\\). Ferguson et al propose an Empirical Bayes approach, which estimate the prior density distribution with the data (Ferguson, Cho, Yang, &amp; Zhao, 2013). This is a nonparametric estimate, but still depends on other specifications such as the number of bins, type of splines, etc. Using the empirical prior, the posterior is then calculated, from which the estimate and pseudo-Bayesian credible intervals are derived by considering the 5% and 95% points. This method resulted in better estimates in the higher density regions, but performed worse than conditional likelihood methods on the tails. Thus, the authors propose a combined method, which calculates both the empirical Bayes and the conditional likelihood confidence intervals, and picks the shortest one. One possible problem with this approach is the use of non-HPD intervals, which could change the tail behavior. Jiang and Yu apply the Bayesian framework to power calculations specifically, defining “Bayesian power” as the marginal probability of finding significance in a replicated study given the original and the data. They also use a spike and slab prior, but estimate the hyperparameters empirically. The resulting power estimators are improved, but lead to downwards bias in the effect size.(Jiang &amp; Yu, 2016) "],
["4-models.html", "Chapter 4 Models", " Chapter 4 Models "],
["5-simulation-study.html", "Chapter 5 Simulation Study 5.1 Normal Example 5.2 Double Exponential Simulation with Adjusted P-Values", " Chapter 5 Simulation Study 5.1 Normal Example 5.1.1 Data Generation To test the hypothesis \\(H_0: mu = 0\\) versus \\(H_1: mu \\neq 0\\), a fixed proportion (set at 0.5) of null vs. alternative hypotheses are generated. For each hypothesis \\(H_i\\), let \\(mu_i = 0\\) in the null scenario and \\(mu_i \\sim N(0,1)\\) in the alternative. The data \\(Y_i\\) is generated from a normal distribution with mean \\(mu_i\\) and known variance 1, with sample size 10. If \\(Y_i\\) is not significant at \\(alpha = .05\\), it is sampled again from the same distribution until the sufficient statistic is significant. This is done in order to properly compare the Bayesian approach with the frequentist one, which is conditional on the data being significant. 5.1.2 Conditional Likelihood Let \\(B\\) indicate that the data is significant at the level \\(\\alpha\\). The conditional likelihood \\(L(\\mu | B) = \\frac{P(Y| \\mu)P(B| Y,\\mu)}{P(B|\\mu)} = \\frac{P(Y| \\mu)}{\\int_{\\text{significant Y}} P(t| \\mu) dt }\\). In this case, the sufficient statistic can be used to simplify: since \\(\\bar Y \\sim N(\\mu, \\sigma^2/n)\\), the conditional likelihood for the simulated data is equivalent to \\(L(\\mu|\\bar Y) = \\frac{\\phi((\\bar Y-\\mu)/\\sqrt{n})}{\\Phi(Z_{\\alpha/2}-\\mu\\sqrt{n})+\\Phi(Z_{1-\\alpha/2}-\\mu\\sqrt{n})}\\). Since this likelihood is difficult to integrate analytically, the confidence intervals were estimated by treating the conditional likelihood as if it were a posterior distribution with an improper prior \\(\\pi(\\mu) = 1\\), and obtaining the HPD (highest posterior density) region covering 95%. Sampling was done through a Metropolis-Hastings algorithm. 5.1.3 Posterior Distribution Let \\(\\delta_a(x)\\) be the Dirac delta function: \\(\\delta_a(x) = 1\\) for \\(x = a\\) and \\(\\delta_a(x)=0\\) otherwise. In the Bayesian case, the prior was set to a spike and slab prior, with the “spike” being a point mass at 0: \\(\\pi(\\mu|H=H_0) = \\delta_0(\\mu)\\), and the “slab” part corresponding to a unit information prior: \\(\\pi(\\mu|H=H_1) \\sim N(0, 1)\\). The full prior is a mixture model \\(\\pi(\\mu|\\xi) = \\xi \\delta_0(\\mu)+ (1-\\xi )\\phi(\\mu)\\). In this case, \\(\\xi = 0.5\\) is a constant. Note that this is also the true data generating model. The marginal posterior distribution is \\(P(\\mu | Y ) = P(H_0|Y)P(\\mu|Y, H_0) + P(H_1|Y)P(\\mu|Y, H_1)\\). The separate posteriors for \\(\\mu\\) are: \\(P(\\mu|Y, H_0) = \\delta_0(\\mu)\\), \\(P(\\mu|Y, H_1) \\sim N(\\frac{n}{n+1}\\bar Y, \\frac{1}{n+1})\\). The posterior for the alternative hypothesis can be calculated using its bayes factor, BF and the prior odds, \\(\\pi = \\frac{(1-\\xi)}{\\xi}\\): \\(P(H_1| Y ) = \\frac{\\pi BF}{1-\\pi BF}\\). For this example, the prior odds are 1 (because the probability of \\(H_1 = \\xi = 0.5\\)). The bayes factor \\(BF = \\frac{L(\\bar Y | H_1)}{L(\\bar Y | H_0)} = \\sqrt{n+1} exp(\\frac{n^2}{2(n+1)}(\\bar Y)^2)\\). This result comes from the fact that the marginal likelihood \\(L(\\bar Y | H_1) \\sim N(0, \\frac{n}{n+1})\\). Putting these pieces together results in the marginal posterior for \\(\\mu\\), which can be used to generate samples to calculate HPD credible intervals. While true HPD intervals can be disjoint, the intervals calculated for this experiment are actually the shortest continuous segments covering \\(.95\\). This corresponds to the HPD interval under the assumption that the distribution is not severely multimodal, and is what most packages in R use to estimate HPD intervals. However, since this posterior is actually a mixture model, a large enough posterior probability for \\(H_1\\) could lead to a difference between the true HPD credible interval and the calculated one. 5.1.4 Results 5.1.4.1 Estimators ##plot of estimators or mse require(reshape2) Loading required package: reshape2 require(knitr) require(ggplot2) load(&quot;normalresults.RData&quot;) results &lt;- fullresults estimators &lt;- data.frame(bayes = abs(results$bayes.est-results$mu),naive = abs(results$Ybar-results$mu), cond.mean = abs(results$cond.mean.est-results$mu),cond.mode = abs(results$cond.mode.est-results$mu)) ggplot(data = melt(estimators), aes(x=variable, y=value)) + geom_boxplot(aes(fill=variable)) No id variables; using all as measure variables Warning: Removed 957 rows containing non-finite values (stat_boxplot). kable(c(bayes = sqrt(sum(estimators$bayes^2)), cond.mean = sqrt(sum(estimators$cond.mean^2)), cond.mode = sqrt(sum(estimators$cond.mode^2)), naive= sqrt(sum(estimators$naive^2))), col.names = &quot;RMSE&quot;) RMSE bayes NA cond.mean NA cond.mode NA naive 5.188799 The conditional likelihood mode (i.e. MLE) has the smallest bias (absolute error) for \\(\\mu\\), while the RMSE for the bayesian estimator (mean of the posterior) is the lowest. 5.1.4.2 Credible and Confidence Intervals ##plot of credible interval sizes ggplot(data = results)+ geom_point(aes(x = conf.upper-conf.lower, y = cred.upper-cred.lower, colour = abs(Ybar)))+geom_abline(intercept = 0, slope = 1)+geom_hline(yintercept=2*1.96*sqrt(1/100))+geom_vline(xintercept=2*1.96*sqrt(1/100)) Warning: Removed 319 rows containing missing values (geom_point). The lines mark the \\(y = x\\) line, and the length of naive confidence intervals (which are constant for fixed number of samples) on the x and y axes. The largest values for the significant statistic also correspond to the largest intervals in both cases. Note that the conditional likelihood confidence intervals are almost always larger than the credible intervals, but still mostly smaller than the naive ones. 5.1.4.3 Coverage The marginal coverage of the (frequentist conditional likelihood) confidence interval C, \\(P(\\mu \\in C|Y) = P(\\mu \\in C|H_0) P(H_0|Y)+P(\\mu \\in C|H_1) P(H_1|Y)\\) will be significantly higher than .95 for the cases in which \\(0 \\in C\\), since \\(P(\\mu \\in C|H_1) =0.95\\) by definition, and \\(P(\\mu \\in C|H_0) = I_{0 \\in C}\\). In this experiment, the expected coverage is \\(0.98\\) for intervals with 0, and only \\(0.38\\) for those that do not contain 0. However, conditioning on the alternative hypothesis does not lead to an empirical coverage of 95%. We can see that both methods are still significantly better than the naive one. #table of expected vs empirical coverage results &lt;- na.omit(results) kable(c(naive = mean(results$naive.cov), conditional = mean(results$freq.cov),bayesian = mean(results$bayes.cov)), col.names = c(&quot;Empirical Coverage&quot;), caption = &quot;coverage for 95% confidence/credible intervals&quot;) Table 5.1: coverage for 95% confidence/credible intervals Empirical Coverage naive 0.6049927 conditional 0.8737151 bayesian 0.8737151 b &lt;- which(results$H==0) kable(c(naive = mean(results[b,]$naive.cov), conditional = mean(results[b,]$freq.cov),bayesian = mean(results[b,]$bayes.cov)), col.names = c(&quot;Empirical Coverage&quot;), caption = &quot;coverage for 95% confidence/credible intervals conditional on H0&quot;) Table 5.1: coverage for 95% confidence/credible intervals conditional on H0 Empirical Coverage naive 0.5635246 conditional 1.0000000 bayesian 1.0000000 kable(c(naive = mean(results[-b,]$naive.cov), conditional = mean(results[-b,]$freq.cov),bayesian = mean(results[-b,]$bayes.cov)), col.names = c(&quot;Empirical Coverage&quot;), caption = &quot;coverage for 95% confidence/credible intervals conditional on H1&quot;) Table 5.1: coverage for 95% confidence/credible intervals conditional on H1 Empirical Coverage naive 0.7098446 conditional 0.5544041 bayesian 0.5544041 5.1.4.4 Hypothesis Rejection(??) Due to the nature of p-values, an \\(\\alpha = 0.05\\) corresponds to a posterior probability \\(P(H_1 | Y )\\) of only \\(0.4\\) for \\(N = 100\\). This means that the 95% credible interval for \\(\\mu| Y\\) will contain 0 every time. In terms of hypothesis testing, if we consider the strategy of rejecting the null when the interval does not contain 0, this level for \\(\\alpha\\) leads to no rejections. ##confusion matrices kable(table(results$H,abs(results$Ybar)/sqrt(1/100)&lt;qnorm(1-0.05/2))/dim(results)[1], col.names = c(&quot;Do not reject null&quot;, &quot;Reject null&quot;), row.names = TRUE, caption = &quot;Naive method&quot;) Table 5.2: Naive method Do not reject null Reject null 0 0.3127753 0.4038179 1 0.1497797 0.1336270 kable(table(results$H,results$conf.upper&gt;=0&amp;results$conf.lower&lt;=0)/dim(results)[1], col.names = c(&quot;Do not reject null&quot;), row.names = TRUE, caption = &quot;Conditional Likelihood Method&quot;) Table 5.2: Conditional Likelihood Method Do not reject null 0 0.7165932 1 0.2834068 kable(table(results$H,results$cred.upper&gt;=0&amp;results$cred.lower&lt;=0)/dim(results)[1], col.names = c(&quot;Do not reject null&quot;), row.names = TRUE, caption = &quot;Bayesian Mixture Model&quot;) Table 5.2: Bayesian Mixture Model Do not reject null 0 0.7165932 1 0.2834068 Despite never rejecting the null, the conditional likelihood and the bayesian methods both perform better than the naive one in terms of “predicting” accurately. The naive method is especially problematic in that it has a higher Type 1 error (false positives) than true positives OR true negatives in the region of the data. 5.2 Double Exponential Simulation with Adjusted P-Values "],
["6-application.html", "Chapter 6 Application 6.1 Genome Study", " Chapter 6 Application 6.1 Genome Study In process of making sure data is available to public, etc "],
["7-discussion.html", "Chapter 7 Discussion", " Chapter 7 Discussion "],
["references.html", "References", " References "]
]
